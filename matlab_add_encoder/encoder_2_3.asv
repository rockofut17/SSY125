function bits_en = encoder_e4_nzt(bits_in)
    D_1=0;
    D_2=0;
    D_3=0;
    R=2/3;
    c_1=0;
    c_2=0;
    c_3=0;
    bits_en = zeros(1, length(bits_in)/R);
    j=1;
    for i=1:2:length(bits_in)
        j=j+1;
        c_1=D_3;
        c_2=bits_in(i);
        c_3=bits_in(i+1);
        D_1=D_3;
        D_2=xor(bits_in(i+1),D_1);
        D_3=xor(bits_in(i),D_2);
        bits_en(j-1)=c_1;
        bits_en(j+1)=c_2;
        bits_en(j+2)=c_3;
    end

end